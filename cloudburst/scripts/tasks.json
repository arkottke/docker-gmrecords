{
  "programName": "gmrecords",
  "$schema": "tasks.schema.json",
  "itemName": "${WORK_ITEM}",
  "fetch": [
    {
      "name": "fetch configs",
      "bucket": "${BUCKET_NAME}",
      "key": "database/conf",
      "dest": "/working/database/conf",
      "exitOnError": true
    },
    {
      "name": "fetch project config",
      "bucket": "${BUCKET_NAME}",
      "key": "database/.gmprocess",
      "dest": "/working/database/.gmprocess",
      "exitOnError": true
    },
    {
      "name": "fetch workspace file",
      "bucket": "${BUCKET_NAME}",
      "key": "database/downloaded/downloaded/${WORK_ITEM}/workspace.h5",
      "dest": "/working/database/downloaded/${WORK_ITEM}/workspace.h5",
      "exitOnError": false
    },
    {
      "name": "fetch helper file",
      "bucket": "${BUCKET_NAME}",
      "key": "scripts/gmrecords-helper.sh",
      "dest": "/working/scripts/gmrecords-helper.sh",
      "exitOnError": true
    }
  ],
  "tasks": [
    {
      "name": "gmrecords",
      "command": "cd /working/scripts && zsh gmrecords-helper.sh -p -n0 ${WORK_ITEM}"
    }
  ],
  "store": [
    {
      "name": "store h5 output",
      "bucket": "${BUCKET_NAME}",
      "source": "/working/database/data/${WORK_ITEM}/workspace.h5",
      "dest": "database/data/${WORK_ITEM}/workspace.h5",
      "compress": false,
      "exitOnError": true
    },
    {
      "name": "store datatables",
      "bucket": "${BUCKET_NAME}",
      "source": "/working/database/data/${WORK_ITEM}/mtables-${WORK_ITEM}.tar.gz",
      "dest": "database/data/${WORK_ITEM}/mtables-${WORK_ITEM}.tar.gz",
      "compress": false,
      "exitOnError": true
    }
  ]
}
